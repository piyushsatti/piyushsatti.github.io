---
import BaseLayout from "./BaseLayout.astro";
import Post from "../components/Post.astro";

export interface LinkProps {
  label: string;
  href: string;
  external?: boolean;
}

export interface MetaProps {
  label: string;
  value: string;
}

export interface Props {
  title: string;
  description?: string;
  summary?: string;
  variant?: "blog" | "projects" | "research";
  pubDate?: Date | string;
  updatedDate?: Date | string;
  author?: string;
  image?: string;
  imageAlt?: string;
  imageCaption?: string;
  tags?: string[];
  links?: LinkProps[];
  meta?: MetaProps[];
  repo?: string;
  demo?: string;
  paper?: string;
  tldr?: string[];
}

const {
  title,
  description,
  summary = description,
  variant = "blog",
  pubDate,
  updatedDate,
  author,
  image,
  imageAlt,
  imageCaption,
  tags = [],
  links = [],
  meta = [],
  repo,
  demo,
  paper,
  tldr,
} = Astro.props as Props;

const aggregatedLinks = [
  ...links,
  ...(repo ? [{ label: "Repo", href: repo, external: true }] : []),
  ...(demo ? [{ label: "Demo", href: demo, external: true }] : []),
  ...(paper ? [{ label: "Paper", href: paper, external: true }] : []),
];

const aggregatedMeta = [
  ...(author ? [{ label: "Author", value: author }] : []),
  ...meta,
];
---

<BaseLayout title={title} description={description} image={image}>
  <Post
    title={title}
    description={description}
    summary={summary}
    variant={variant}
    heroImage={image}
    heroImageAlt={imageAlt}
    heroImageCaption={imageCaption}
    pubDate={pubDate}
    updatedDate={updatedDate}
    tags={tags}
    links={aggregatedLinks}
    meta={aggregatedMeta}
    tldr={tldr}
  >
    <slot />
  </Post>
</BaseLayout>
