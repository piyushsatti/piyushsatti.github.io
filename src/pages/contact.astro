---
import BaseLayout from "../layouts/BaseLayout.astro";
const base = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";
---

<BaseLayout title="Contact">
  <!-- Use the same wrapper your other pages use so the CSS applies identically -->
  <div class="index-content framed">
    <h1>Contact</h1>

    <p>
      <strong>Email:</strong>
      <a href="mailto:piyushsatti@gmail.com">piyushsatti@gmail.com</a>
    </p>

    <form
      id="contact-form"
      class="contact-form"
      action="mailto:piyushsatti@gmail.com"
      method="POST"
      enctype="text/plain"
    >
      <label>
        Your email
        <input type="email" name="email" required />
      </label>

      <label>
        Your message
        <textarea name="message" rows="6" required></textarea>
      </label>

      <button type="submit" class="button">Draft email</button>
    </form>

    <p class="contact-note">
      Submitting opens your default mail client so you can review the message
      before sending.
    </p>

    <p style="margin-top: 2rem;">
      <a
        href="https://github.com/piyushsatti"
        target="_blank"
        rel="noopener noreferrer">GitHub</a
      > ::
      <a
        href="https://www.linkedin.com/in/piyush-satti/"
        target="_blank"
        rel="noopener noreferrer">LinkedIn</a
      >
    </p>
  </div>
</BaseLayout>

<script is:inline>
  const form = document.querySelector("#contact-form");
  if (form) {
    form.addEventListener("submit", (event) => {
      event.preventDefault();

      const formData = new FormData(form);
      const sender = (formData.get("email") || "").toString().trim();
      const message = (formData.get("message") || "").toString().trim();

      const subjectBase = "Portfolio contact";
      const subject = sender ? `${subjectBase} from ${sender}` : subjectBase;

      const bodyLines = [];
      if (message) bodyLines.push(message);
      if (sender) bodyLines.push("", `Reply to: ${sender}`);

      const mailto = `mailto:piyushsatti@gmail.com?subject=${encodeURIComponent(
        subject
      )}&body=${encodeURIComponent(bodyLines.join("\n"))}`;

      window.location.href = mailto;
    });
  }
</script>
