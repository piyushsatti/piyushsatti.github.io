---
import BaseLayout from "../layouts/BaseLayout.astro";
const base = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";
---

<BaseLayout title="Contact">

  <header class="contact-header">
    <h1>Contact</h1>
    <p class="contact-subtitle">
      Leave a quick note and I'll get back to you shortly. Prefer email? Reach
      out directly anytime.
    </p>
  </header>

  <div class="contact-meta">
    <span class="contact-meta__label">Email</span>
    <a class="contact-meta__value" href="mailto:piyushsatti@gmail.com">
      piyushsatti@gmail.com
    </a>
  </div>

  <form
    id="contact-form"
    class="contact-form"
    action="mailto:piyushsatti@gmail.com"
    method="POST"
    enctype="text/plain"
  >
    <div class="contact-field">
      <label for="contact-email">Your email</label>
      <input id="contact-email" type="email" name="email" required />
    </div>

    <div class="contact-field">
      <label for="contact-message">Your message</label>
      <textarea id="contact-message" name="message" rows="6" required
      ></textarea>
    </div>

    <div class="contact-actions">
      <button type="submit" class="button">Draft email</button>
      <a class="contact-secondary" href="mailto:piyushsatti@gmail.com">
        or open a blank email
      </a>
    </div>
  </form>

  <p class="contact-note">
    Drafting opens your default mail client so you can review the message
    before sending.
  </p>

  <div class="contact-links">
    <a
      href="https://github.com/piyushsatti"
      target="_blank"
      rel="noopener noreferrer">GitHub</a
    >
    <span aria-hidden="true" class="contact-separator">::</span>
    <a
      href="https://www.linkedin.com/in/piyush-satti/"
      target="_blank"
      rel="noopener noreferrer">LinkedIn</a
    >
  </div>

</BaseLayout>

<script is:inline>
  const form = document.querySelector("#contact-form");
  if (form) {
    form.addEventListener("submit", (event) => {
      event.preventDefault();

      const formData = new FormData(form);
      const sender = (formData.get("email") || "").toString().trim();
      const message = (formData.get("message") || "").toString().trim();

      const subjectBase = "Portfolio contact";
      const subject = sender ? `${subjectBase} from ${sender}` : subjectBase;

      const bodyLines = [];
      if (message) bodyLines.push(message);
      if (sender) bodyLines.push("", `Reply to: ${sender}`);

      const mailto = `mailto:piyushsatti@gmail.com?subject=${encodeURIComponent(
        subject
      )}&body=${encodeURIComponent(bodyLines.join("\n"))}`;

      window.location.href = mailto;
    });
  }
</script>
